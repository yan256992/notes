## 🐤 正则表达式

**问题**

- 如何判断字符串是否是有效的电话号码？例如：`010-1234567`，`123ABC456`，`13510001000`等；
- 如何判断字符串是否是有效的电子邮件地址？例如：`test@example.com`，`test#example`等；
- 如何判断字符串是否是有效的时间？例如：`12:34`，`09:60`，`99:99`等。

我们可以通过程序判断，但是这种方法需要我们为每一种用例都创建规则，然后用代码实现，为每一种判断逻辑编写代码实在是太繁琐了，因此引入了`正则表达式`

正则表达式是一套标准，它可以用于任何语言。Java标准库的`java.util.regex`包内置了正则表达式引擎，在Java程序中使用正则表达式非常简单。



例如我们要判断用户输入的年份是否是`20##`年，我们可以写出规则如下：

一共有四个字符，分别是2 0 x x

对应的正则表达式就是`20\d\d`，其中`\d`表示任意一个数字。把正则表达式转换为Java字符串就变成了`20\\d\\d`，注意Java字符串用`\\`表示`\`。

```Java
public static void main(String[] args) {
    String str = "20\\d\\d";
    System.out.println("2019".matches(str));//true
    System.out.println("2119".matches(str));//false
}
```

### 匹配规则

> 正则表达式匹配规则是从左到右按规则匹配，如果正则表达式有特殊字符，那就需要用`\`转义，例如正则表达式`a\&c`，其中`\&`是用来匹配特殊字符`&`的，它能精确匹配字符串`"a&c"`，但不能匹配`"ac"`、`"a-c"`、`"a&&c"`等。

所以，对于正则表达式`a\&c`来说，对应的Java字符串是`"a\\&c"`，因为`\`也是Java字符串的转义字符，两个`\\`实际上表示的是一个`\`：

如果想匹配非ASCII字符，那么就用`\u####`的十六进制表示。`a\u548cc`匹配字符串`"a和c"`，中文字符`和`的Unicode编码是`548c`。

1. **匹配任意字符**

   `.`代表任意一个字符例如，正则表达式`a.c`中间的`.`可以匹配一个任意字符，例如，下面的字符串都可以被匹配：

   - `"abc"`，因为`.`可以匹配字符`b`；
   - `"a&c"`，因为`.`可以匹配字符`&`；
   - `"acc"`，因为`.`可以匹配字符`c`。

2. **匹配数字**

   `\d`代表一个数字

3. **匹配常用字符**

   `\w`可以匹配有一个字母，数字，下划线、但是不可以匹配空格#等字符

4. **匹配空格字符**

   `\s`可以匹配一个空格字符，同时还可以匹配一个tab

5. **匹配非数字**

   `\D`匹配非数字

6. **重复匹配**

   - 匹配任意字符`*`例如`A\d*`代表可以匹配0个或多个数字

   - 匹配至少一个字符`+`,必须加上至少一个字符

   - 匹配0个或者1个`?`

   - 如果我们想精确指定n个字符怎么办？用修饰符`{n}`就可以。`A\d{3}`可以精确匹配：

     - `A380`：因为`\d{3}`可以匹配3个数字`380`。

     如果我们想指定匹配n~m个字符怎么办？用修饰符`{n,m}`就可以。`A\d{3,5}`可以精确匹配：

     - `A380`：因为`\d{3,5}`可以匹配3个数字`380`；
     - `A3800`：因为`\d{3,5}`可以匹配4个数字`3800`；
     - `A38000`：因为`\d{3,5}`可以匹配5个数字`38000`。

     如果没有上限，那么修饰符`{n,}`就可以匹配至少n个字符。

单个字符的匹配规则如下：

| 正则表达式 | 规则                     | 可以匹配                       |
| :--------- | :----------------------- | :----------------------------- |
| `A`        | 指定字符                 | `A`                            |
| `\u548c`   | 指定Unicode字符          | `和`                           |
| `.`        | 任意字符                 | `a`，`b`，`&`，`0`             |
| `\d`       | 数字0~9                  | `0`~`9`                        |
| `\w`       | 大小写字母，数字和下划线 | `a`~`z`，`A`~`Z`，`0`~`9`，`_` |
| `\s`       | 空格、Tab键              | 空格，Tab                      |
| `\D`       | 非数字                   | `a`，`A`，`&`，`_`，……         |
| `\W`       | 非\w                     | `&`，`@`，`中`，……             |
| `\S`       | 非\s                     | `a`，`A`，`&`，`_`，……         |

多个字符的匹配规则如下：

| 正则表达式 | 规则             | 可以匹配                 |
| :--------- | :--------------- | :----------------------- |
| `A*`       | 任意个数字符     | 空，`A`，`AA`，`AAA`，…… |
| `A+`       | 至少1个字符      | `A`，`AA`，`AAA`，……     |
| `A?`       | 0个或1个字符     | 空，`A`                  |
| `A{3}`     | 指定个数字符     | `AAA`                    |
| `A{2,3}`   | 指定范围个数字符 | `AA`，`AAA`              |
| `A{2,}`    | 至少n个字符      | `AA`，`AAA`，`AAAA`，……  |
| `A{0,3}`   | 最多n个字符      | 空，`A`，`AA`，`AAA`     |

复杂匹配规则主要有：

| 正则表达式 | 规则                 | 可以匹配                             |
| :--------- | :------------------- | :----------------------------------- |
| ^          | 开头                 | 字符串开头                           |
| $          | 结尾                 | 字符串结束                           |
| [ABC]      | […]内任意字符        | A，B，C                              |
| [A-F0-9xy] | 指定范围的字符       | `A`，……，`F`，`0`，……，`9`，`x`，`y` |
| [^A-F]     | 指定范围外的任意字符 | 非`A`~`F`                            |
| AB\|CD\|EF | AB或CD或EF           | `AB`，`CD`，`EF`                     |

### Reference

- 廖雪峰：https://www.liaoxuefeng.com/