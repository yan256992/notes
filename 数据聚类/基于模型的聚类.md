# 基于模型的聚类

## 2.1 混合模型

### 2.1.1 高斯混合模型

在高斯混合模型中，每个簇都是由高斯分布构成的，只是每个高斯分布的均值和方差不同，高斯混合模型主要引用于数据特征是连续值的数据聚类中。高斯分布也叫正态分布![image-20210813101552264](https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210813101552264.png)

**均值：**<img src="https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210903154326826.png" alt="image-20210903154326826" style="zoom:50%;" />

**方差：![img](https://gitee.com/yan256992/cloudimages/raw/master/img/310680-20160426134941330-2099994297.png)**

**标准差：**<img src="https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210903154442574.png" alt="image-20210903154442574" style="zoom:50%;" />

方差衡量随机变量或一组数据时==离散程度==的度量。概率论中方差用来度量随机变量和其数学期望（即均值）之间的偏离程度。统计中的方差（样本方差）是各个数据分别与其平均数之差的平方的和的平均数

![img](https://pic3.zhimg.com/80/v2-0c2fbaf73ff52a52efb693eaeb835070_720w.jpg?source=1940ef5c)

 **协方差**

标准差和方差是用来描述一维数据的，但现实生活中我们常常会遇到含有多维数据的数据集，对于多维的数据集，可以按照每一维度独立计算其方差。协方差可以用来衡量==两个随机变量之间的关系==![clip_image002[8]](https://gitee.com/yan256992/cloudimages/raw/master/img/10144507-318040d3955c47f5a2bdd098974bcc79.gif)

如果结果为正值，则说明两者是正相关的

我们可以举一个三维的例子，假设数据集有三个维度，则协方差矩阵为：

![image-20210813103104414](https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210813103104414.png)

可见，协方差矩阵是一个对称的矩阵，而且对角线是各个维度的方差。

![image-20210813103339438](https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210813103339438.png)

![image-20210813103559072](https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210813103559072.png)

### 2.1.2 伯努利混合模型

>  在伯努利混合模型中，每个簇都是有伯努利分布构成，只是伯努利分布的参数不同，伯努利混合模型主要应用于数据特征是离散值的数据聚类中。

一元随机变量x的伯努利分布为<img src="C:\Users\25699\AppData\Roaming\Typora\typora-user-images\image-20210813103957897.png" alt="image-20210813103957897" style="zoom:50%;" />，u是参数，例如在抛硬币中 x=0代表成功 1 代表失败，概率u为0.5

多元随机变量的伯努利分布为<img src="https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210813104208829.png" alt="image-20210813104208829" style="zoom:50%;" />

![image-20210813104442701](https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210813104442701.png)

### 2.1.3 模型选择

选取簇的个数K 主要由两类：==确定性==和==随机性==方法

确定性<img src="https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210813104747548.png" alt="image-20210813104747548" style="zoom:50%;" />

## 2.2  期望最大化

**似然函数** P(x∣θ)

输入有两个：x表示某一个具体的数据；θ表示模型的参数。

如果θ 是已知确定的，x是变量，这个函数叫做概率函数(probability function)，它描述对于不同的样本点x，其出现概率是多少。

如果x是已知确定的，θ 是变量，这个函数叫做似然函数(likelihood function), 它描述对于不同的模型参数，出现x这个样本点的概率是多少。

**极大似然估计**就是利用已知的样本结果信息，反推最具有可能（最大概率）导致这些样本结果出现的模型参数值！

假如有一个罐子，里面有黑白两种颜色的球，数目多少不知，两种颜色的比例也不知。我 们想知道罐中白球和黑球的比例，但我们不能把罐中的球全部拿出来数。现在我们可以每次任意从已经摇匀的罐中拿一个球出来，记录球的颜色，然后把拿出来的球 再放回罐中。这个过程可以重复，我们可以用记录的球的颜色来估计罐中黑白球的比例。假如在前面的一百次重复记录中，有七十次是白球，请问罐中白球所占的比例最有可能是多少？

假设罐中白球的比例是p，那么黑球的比例就是1-p。因为每抽一个球出来，在记录颜色之后，我们把抽出的球放回了罐中并摇匀，**所以每次抽出来的球的颜 色服从同一独立分布。**

这里我们把一次抽出来球的颜色称为一次抽样。题目中在一百次抽样中，七十次是白球的,三十次为黑球事件的概率是P(样本结果|Model)。

如果第一次抽象的结果记为x1,第二次抽样的结果记为x2....那么样本结果为(x1,x2.....,x100)。这样，我们可以得到如下表达式：

P(样本结果|Model)

　　= P(x1,x2,…,x100|Model)

　　= P(x1|Mel)P(x2|M)…P(x100|M)

　　=  p^70(1-p)30

不同的p 会导致最终的结果也不同 **我们想办法让观察样本出现的概率最大，转换为数学问题就是使得：**p^70(1-p)^30最大，这太简单了，未知数只有一个p，我们令其导数为0，即可求出p为70%，与我们一开始认为的70%是一致的。其中蕴含着我们的数学思想在里面。

<img src="https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210813162509802.png" alt="image-20210813162509802" style="zoom: 80%;" />

> 最大似然估计https://zhuanlan.zhihu.com/p/26614750
>
> https://blog.csdn.net/guoziqing506/article/details/81274276

#### 期望最大化算法（EM）

> 如果已知的数据中含有某些无法观测的隐藏变量时，直接使用最大似然估计是不足以解决问题的。这个时候就要依靠最大化期望（EM）算法了。
>
> **EM算法是在依赖于无法观测的隐藏变量的概率模型中，寻找参数最大似然估计或者最大后验估计的算法。**

属于多个类别的样本混在了一起，不同类别样本的参数不同，现在的任务是从总体中抽样，再通过抽样数据估计每个类别的分布参数。这个描述就是所谓的“在依赖于无法观测的隐藏变量的概率模型中，寻找参数最大似然估计”，隐藏变量在此处就是样本的类别（比如上例中的男女）。这个时候EM算法就派上用场了。

> 期望最大化算法的用处：如果我们得到的抽样样本知道它的类别，那么就可以使用最大似然估计算法求出它的参数值。但是如果得到的样本并不知道它到底属于哪一个类别，这就是隐藏变量 此就要用到EM算法

**两个关键步骤** 

- E 期望步 根据当前的参数值，计算样本隐藏变量的期望；
- M 最大化步 根据当前样本的隐藏变量，求解参数的最大似然估计；



#### 具体步骤

<img src="https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210813185302730.png" alt="image-20210813185302730" style="zoom: 80%;" />

<img src="https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210813185352584.png" alt="image-20210813185352584" style="zoom:80%;" />

![image-20210813185450195](https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210813185450195.png)

![image-20210813185524818](https://gitee.com/yan256992/cloudimages/raw/master/img/image-20210813185524818.png)